--- GIN_STP_PKG_HERITAGE_procedures_duplicate_risk.sql
+++ GIN_STP_PKG_NEW_GEMINIA_procedures_duplicate_risk.sql
@@ -1,240 +1,704 @@
 PROCEDURE duplicate_risk (v_ipu_code NUMBER)
-   IS
-      v_new_ipu_code   NUMBER;
-   BEGIN
-      SELECT TO_NUMBER (TO_CHAR (SYSDATE, 'RRRR')) || gin_ipu_code_seq.NEXTVAL
-        INTO v_new_ipu_code
-        FROM DUAL;
+    IS
+        v_new_ipu_code       NUMBER;
+        v_ipu_pol_batch_no   NUMBER;
+        v_is_motor_risk      CHAR;
+    BEGIN
+        SELECT IPU_POL_BATCH_NO, SCL_MOTOR_VERIFY
+          INTO v_ipu_pol_batch_no, v_is_motor_risk
+          FROM GIN_INSURED_PROPERTY_UNDS, GIN_SUB_CLASSES
+         WHERE IPU_SEC_SCL_CODE = SCL_CODE AND IPU_CODE = v_ipu_code;
 
-      INSERT INTO gin_insured_property_unds
-                  (ipu_code, ipu_property_id, ipu_item_desc, ipu_qty,
-                   ipu_value, ipu_wef, ipu_wet, ipu_pol_policy_no,
-                   ipu_pol_ren_endos_no, ipu_pol_batch_no, ipu_basic_premium,
-                   ipu_nett_premium, ipu_compulsory_excess,
-                   ipu_add_theft_excess, ipu_add_exp_excess, ipu_prr_rate,
-                   ipu_comp_retention, ipu_pol_est_max_loss,
-                   ipu_avail_fulc_bal, ipu_endos_diff_amt, ipu_prem_wef,
-                   ipu_earth_quake_cover, ipu_earth_quake_prem, ipu_location,
-                   ipu_itl, ipu_polin_code, ipu_sec_sect_code,
-                   ipu_sect_sht_desc, ipu_sec_scl_code, ipu_ncd_status,
-                   ipu_cert_issued, ipu_related_ipu_code, ipu_prorata, ipu_bp,
-                   ipu_gp, ipu_fp, ipu_fap, ipu_prev_ipu_code,
-                   ipu_cummulative_reins, ipu_eml_si, ipu_reinsured,
-                   ipu_ct_code, ipu_sht_desc, ipu_quz_code, ipp_quz_sht_desc,
-                   ipu_quz_sht_desc, ipu_ncl_level, ipu_ncd_level, ipu_id,
-                   ipu_gross_comp_retention, ipu_bind_code, ipu_commission,
-                   ipu_comm_endos_diff_amt, ipu_facre_amount, ipu_clp_code,
-                   ipu_excess_rate, ipu_excess_type, ipu_excess_rate_type,
-                   ipu_excess_min, ipu_excess_max, ipu_prereq_ipu_code,
-                   ipu_escalation_rate, ipu_endos_remove, ipu_comm_rate,
-                   ipu_prev_batch_no, ipu_cur_code, ipu_relr_code,
-                   ipu_relr_sht_desc, ipu_reinsure_amt, ipu_prp_code,
-                   ipu_max_exposure, ipu_com_retention_rate, ipu_eff_wef,
-                   ipu_eff_wet, ipu_retro_cover, ipu_retro_wef, ipu_covt_code,
-                   ipu_covt_sht_desc, ipu_si_diff, ipu_terr_code,
-                   ipu_terr_desc, ipu_comments, ipu_from_time, ipu_to_time,
-                   ipu_mar_cert_no, ipu_tot_endos_prem_dif, ipu_tot_gp,
-                   ipu_tot_value, ipu_cover_days, ipu_grp_comp_net_ret,
-                   ipu_grp_si_risk_pct, ipu_grp_top_loc,
-                   ipu_grp_comp_gross_ret, ipu_prev_prem,
-                   ipu_current_prrd_code, ipu_ri_agnt_com_rate,
-                   ipu_ri_agnt_comm_amt, ipu_tot_fap, ipu_max_dc_refund_pct,
-                   ipu_extra_premium, ipu_status, ipu_uw_yr,
-                   ipu_endose_fap_or_bc, ipu_tot_first_loss,
-                   ipu_accumulation_limit, ipu_compute_max_exposure,
-                   ipu_trans_eff_wet, ipu_prem_tax, ipu_rate_change_comment,
-                   ipu_trans_count, ipu_paid_premium, ipu_paid_tl,
-                   ipu_inception_uwyr, ipu_prem_comment, ipu_coin_tl,
-                   ipu_dc_paid_premium, ipu_dc_ap, ipu_item_details,
-                   ipu_eml_based_on, ipu_aggregate_limits, ipu_rc_code,
-                   ipu_rc_sht_desc, ipu_free_limit, ipu_contrad_ipu_code,
-                   ipu_survey_date, ipu_declared, ipu_prev_fap,
-                   ipu_prev_tot_fap, ipu_min_premium_used,
-                   ipu_cancellation_days, ipu_allowed_comm_rate,
-                   ipu_allowed_comm_amt, ipu_dc_penalty_pct,
-                   ipu_reinsure_diff_amt, ipu_prev_reinsure_amt, ipu_phfund,
-                   ipu_coin_phfund, ipu_enforce_cvt_min_prem, ipu_instal_prem,
-                   ipu_prev_ri_si, ipu_policy_status, ipu_earthqke_prem_diff,
-                   ipu_override_ri_retention, ipu_risk_oth_int_parties,
-                   ipu_prorata_sect_prem, ipu_nonprorata_sect_prem,
-                   ipu_prev_prorata_sect_prem, ipu_prev_nonprorata_sect_prem,
-                   ipu_tot_prorata_sect_prem, ipu_tot_nonprorata_sect_prem,
+        SELECT    TO_NUMBER (TO_CHAR (SYSDATE, 'RRRR'))
+               || gin_ipu_code_seq.NEXTVAL
+          INTO v_new_ipu_code
+          FROM DUAL;
+
+        INSERT INTO gin_insured_property_unds (
+                        ipu_code,
+                        ipu_property_id,
+                        ipu_item_desc,
+                        ipu_qty,
+                        ipu_value,
+                        ipu_wef,
+                        ipu_wet,
+                        ipu_pol_policy_no,
+                        ipu_pol_ren_endos_no,
+                        ipu_pol_batch_no,
+                        ipu_basic_premium,
+                        ipu_nett_premium,
+                        ipu_compulsory_excess,
+                        ipu_add_theft_excess,
+                        ipu_add_exp_excess,
+                        ipu_prr_rate,
+                        ipu_comp_retention,
+                        ipu_pol_est_max_loss,
+                        ipu_avail_fulc_bal,
+                        ipu_endos_diff_amt,
+                        ipu_prem_wef,
+                        ipu_earth_quake_cover,
+                        ipu_earth_quake_prem,
+                        ipu_location,
+                        ipu_itl,
+                        ipu_polin_code,
+                        ipu_sec_sect_code,
+                        ipu_sect_sht_desc,
+                        ipu_sec_scl_code,
+                        ipu_ncd_status,
+                        ipu_cert_issued,
+                        ipu_related_ipu_code,
+                        ipu_prorata,
+                        ipu_bp,
+                        ipu_gp,
+                        ipu_fp,
+                        ipu_fap,
+                        ipu_prev_ipu_code,
+                        ipu_cummulative_reins,
+                        ipu_eml_si,
+                        ipu_reinsured,
+                        ipu_ct_code,
+                        ipu_sht_desc,
+                        ipu_quz_code,
+                        ipp_quz_sht_desc,
+                        ipu_quz_sht_desc,
+                        ipu_ncl_level,
+                        ipu_ncd_level,
+                        ipu_id,
+                        ipu_gross_comp_retention,
+                        ipu_bind_code,
+                        ipu_commission,
+                        ipu_comm_endos_diff_amt,
+                        ipu_facre_amount,
+                        ipu_clp_code,
+                        ipu_excess_rate,
+                        ipu_excess_type,
+                        ipu_excess_rate_type,
+                        ipu_excess_min,
+                        ipu_excess_max,
+                        ipu_prereq_ipu_code,
+                        ipu_escalation_rate,
+                        ipu_endos_remove,
+                        ipu_comm_rate,
+                        ipu_prev_batch_no,
+                        ipu_cur_code,
+                        ipu_relr_code,
+                        ipu_relr_sht_desc,
+                        ipu_reinsure_amt,
+                        ipu_prp_code,
+                        ipu_max_exposure,
+                        ipu_com_retention_rate,
+                        ipu_eff_wef,
+                        ipu_eff_wet,
+                        ipu_retro_cover,
+                        ipu_retro_wef,
+                        ipu_covt_code,
+                        ipu_covt_sht_desc,
+                        ipu_si_diff,
+                        ipu_terr_code,
+                        ipu_terr_desc,
+                        ipu_comments,
+                        ipu_from_time,
+                        ipu_to_time,
+                        ipu_mar_cert_no,
+                        ipu_tot_endos_prem_dif,
+                        ipu_tot_gp,
+                        ipu_tot_value,
+                        ipu_cover_days,
+                        ipu_grp_comp_net_ret,
+                        ipu_grp_si_risk_pct,
+                        ipu_grp_top_loc,
+                        ipu_grp_comp_gross_ret,
+                        ipu_prev_prem,
+                        ipu_current_prrd_code,
+                        ipu_ri_agnt_com_rate,
+                        ipu_ri_agnt_comm_amt,
+                        ipu_tot_fap,
+                        ipu_max_dc_refund_pct,
+                        ipu_extra_premium,
+                        ipu_status,
+                        ipu_uw_yr,
+                        ipu_endose_fap_or_bc,
+                        ipu_tot_first_loss,
+                        ipu_accumulation_limit,
+                        ipu_compute_max_exposure,
+                        ipu_trans_eff_wet,
+                        ipu_prem_tax,
+                        ipu_rate_change_comment,
+                        ipu_trans_count,
+                        ipu_paid_premium,
+                        ipu_paid_tl,
+                        ipu_inception_uwyr,
+                        ipu_prem_comment,
+                        ipu_coin_tl,
+                        ipu_dc_paid_premium,
+                        ipu_dc_ap,
+                        ipu_item_details,
+                        ipu_eml_based_on,
+                        ipu_aggregate_limits,
+                        ipu_rc_code,
+                        ipu_rc_sht_desc,
+                        ipu_free_limit,
+                        ipu_contrad_ipu_code,
+                        ipu_survey_date,
+                        ipu_declared,
+                        ipu_prev_fap,
+                        ipu_prev_tot_fap,
+                        ipu_min_premium_used,
+                        ipu_cancellation_days,
+                        ipu_allowed_comm_rate,
+                        ipu_allowed_comm_amt,
+                        ipu_dc_penalty_pct,
+                        ipu_reinsure_diff_amt,
+                        ipu_prev_reinsure_amt,
+                        ipu_phfund,
+                        ipu_coin_phfund,
+                        ipu_enforce_cvt_min_prem,
+                        ipu_instal_prem,
+                        ipu_prev_ri_si,
+                        ipu_policy_status,
+                        ipu_earthqke_prem_diff,
+                        ipu_override_ri_retention,
+                        ipu_risk_oth_int_parties,
+                        ipu_prorata_sect_prem,
+                        ipu_nonprorata_sect_prem,
+                        ipu_prev_prorata_sect_prem,
+                        ipu_prev_nonprorata_sect_prem,
+                        ipu_tot_prorata_sect_prem,
+                        ipu_tot_nonprorata_sect_prem,
+                        ipu_prev_tot_prorata_s_prem,
+                        ipu_prev_tot_nonprorata_s_prem,
+                        ipu_sub_agn_comm_rate,
+                        ipu_sub_agn_comm_amt,
+                        ipu_lta_endos_com_amt,
+                        ipu_lta_commission,
+                        ipu_lta_comm_rate,
+                        ipu_admin_fee_disc_amt,
+                        ipu_admin_fee_disc_rate,
+                        ipu_lta_comm_disc_rate,
+                        ipu_lta_comm_disc_amt,
+                        ipu_tot_families,
+                        ipu_tot_individuals,
+                        ipu_tot_females,
+                        ipu_tot_males,
+                        ipu_conveyance_type,
+                        ipu_stamp_duty,
+                        ipu_mktr_com_amt,
+                        ipu_mktr_com_rate,
+                        ipu_vat_amt,
+                        ipu_vat_rate,
+                        ipu_comm_disc_type,
+                        ipu_comm_disc_rate,
+                        ipu_comm_disc_amt,
+                        ipu_prev_status,
+                        ipu_rs_code,
+                        ipu_rescue_mem,
+                        ipu_ped_code,
+                        ipu_cover_suspended,
+                        ipu_suspend_wef,
+                        ipu_suspend_wet,
+                        ipu_ncd_cert_no,
+                        ipu_pymt_install_pcts,
+                        ipu_susp_reinstmt_type,
+                        ipu_install_period,
+                        ipu_rescue_charge,
+                        ipu_previous_insurer,
+                        ipu_next_inst_prem,
+                        ipu_wtht,
+                        ipu_drcr_no,
+                        ipu_post_retro_wet,
+                        ipu_post_retro_cover,
+                        ipu_co_phfund,
+                        ipu_cover_note_remarks,
+                        ipu_cover_note_wet,
+                        ipu_cover_note_wef,
+                        ipu_cover_note_date,
+                        ipu_cover_note_by,
+                        ipu_cover_note_no,
+                        ipu_health_tax,
+                        ipu_motor_tax,
+                        ipu_certchg,
+                        ipu_road_safety_tax,
+                        ipu_client_vat_amt,
+                        ipu_motor_levy,
+                        ipu_overrideride_ret_type,
+                        ipu_db_code,
+                        ipu_rare_model,
+                        ipu_cashback_appl,
+                        ipu_cashback_level,
+                        ipu_vehicle_model,
+                        ipu_vehicle_make,
+                        ipu_vehicle_model_code,
+                        ipu_vehicle_make_code,
+                        ipu_loc_town,
+                        ipu_prop_address,
+                        ipu_other_com_charges,
+                        ipu_risk_note,
+                        ipu_model_yr,
+                        ipu_insured_driver,
+                        ipu_cert_no,
+                        ipu_validate_ucr,
+                        ipu_ucr_code,
+                        ipu_pip_code,
+                        ipu_pip_pf_code,
+                        ipu_survey_agnt_code,
+                        ipu_quza_code,
+                        ipu_survey,
+                        ipu_maintenance_period_type,
+                        ipu_maintenance_period,
+                        ipu_other_client_deductibles,
+                        ipu_coin_other_client_charges)
+            SELECT v_new_ipu_code,
+                   ipu_property_id,
+                   ipu_item_desc,
+                   ipu_qty,
+                   ipu_value,
+                   ipu_wef,
+                   ipu_wet,
+                   ipu_pol_policy_no,
+                   ipu_pol_ren_endos_no,
+                   ipu_pol_batch_no,
+                   ipu_basic_premium,
+                   ipu_nett_premium,
+                   ipu_compulsory_excess,
+                   ipu_add_theft_excess,
+                   ipu_add_exp_excess,
+                   ipu_prr_rate,
+                   ipu_comp_retention,
+                   ipu_pol_est_max_loss,
+                   ipu_avail_fulc_bal,
+                   ipu_endos_diff_amt,
+                   ipu_prem_wef,
+                   ipu_earth_quake_cover,
+                   ipu_earth_quake_prem,
+                   ipu_location,
+                   ipu_itl,
+                   ipu_polin_code,
+                   ipu_sec_sect_code,
+                   ipu_sect_sht_desc,
+                   ipu_sec_scl_code,
+                   ipu_ncd_status,
+                   ipu_cert_issued,
+                   ipu_related_ipu_code,
+                   ipu_prorata,
+                   ipu_bp,
+                   ipu_gp,
+                   ipu_fp,
+                   ipu_fap,
+                   ipu_prev_ipu_code,
+                   ipu_cummulative_reins,
+                   ipu_eml_si,
+                   ipu_reinsured,
+                   ipu_ct_code,
+                   ipu_sht_desc,
+                   ipu_quz_code,
+                   ipp_quz_sht_desc,
+                   ipu_quz_sht_desc,
+                   ipu_ncl_level,
+                   ipu_ncd_level,
+                      TO_NUMBER (TO_CHAR (SYSDATE, 'RRRR'))
+                   || gin_ipu_id_seq.NEXTVAL,
+                   ipu_gross_comp_retention,
+                   ipu_bind_code,
+                   ipu_commission,
+                   ipu_comm_endos_diff_amt,
+                   ipu_facre_amount,
+                   ipu_clp_code,
+                   ipu_excess_rate,
+                   ipu_excess_type,
+                   ipu_excess_rate_type,
+                   ipu_excess_min,
+                   ipu_excess_max,
+                   ipu_prereq_ipu_code,
+                   ipu_escalation_rate,
+                   ipu_endos_remove,
+                   ipu_comm_rate,
+                   ipu_prev_batch_no,
+                   ipu_cur_code,
+                   ipu_relr_code,
+                   ipu_relr_sht_desc,
+                   ipu_reinsure_amt,
+                   ipu_prp_code,
+                   ipu_max_exposure,
+                   ipu_com_retention_rate,
+                   ipu_eff_wef,
+                   ipu_eff_wet,
+                   ipu_retro_cover,
+                   ipu_retro_wef,
+                   ipu_covt_code,
+                   ipu_covt_sht_desc,
+                   ipu_si_diff,
+                   ipu_terr_code,
+                   ipu_terr_desc,
+                   ipu_comments,
+                   ipu_from_time,
+                   ipu_to_time,
+                   ipu_mar_cert_no,
+                   ipu_tot_endos_prem_dif,
+                   ipu_tot_gp,
+                   ipu_tot_value,
+                   ipu_cover_days,
+                   ipu_grp_comp_net_ret,
+                   ipu_grp_si_risk_pct,
+                   ipu_grp_top_loc,
+                   ipu_grp_comp_gross_ret,
+                   ipu_prev_prem,
+                   ipu_current_prrd_code,
+                   ipu_ri_agnt_com_rate,
+                   ipu_ri_agnt_comm_amt,
+                   ipu_tot_fap,
+                   ipu_max_dc_refund_pct,
+                   ipu_extra_premium,
+                   ipu_status,
+                   ipu_uw_yr,
+                   ipu_endose_fap_or_bc,
+                   ipu_tot_first_loss,
+                   ipu_accumulation_limit,
+                   ipu_compute_max_exposure,
+                   ipu_trans_eff_wet,
+                   ipu_prem_tax,
+                   ipu_rate_change_comment,
+                   ipu_trans_count,
+                   ipu_paid_premium,
+                   ipu_paid_tl,
+                   ipu_inception_uwyr,
+                   ipu_prem_comment,
+                   ipu_coin_tl,
+                   ipu_dc_paid_premium,
+                   ipu_dc_ap,
+                   ipu_item_details,
+                   ipu_eml_based_on,
+                   ipu_aggregate_limits,
+                   ipu_rc_code,
+                   ipu_rc_sht_desc,
+                   ipu_free_limit,
+                   ipu_contrad_ipu_code,
+                   ipu_survey_date,
+                   ipu_declared,
+                   ipu_prev_fap,
+                   ipu_prev_tot_fap,
+                   ipu_min_premium_used,
+                   ipu_cancellation_days,
+                   ipu_allowed_comm_rate,
+                   ipu_allowed_comm_amt,
+                   ipu_dc_penalty_pct,
+                   ipu_reinsure_diff_amt,
+                   ipu_prev_reinsure_amt,
+                   ipu_phfund,
+                   ipu_coin_phfund,
+                   ipu_enforce_cvt_min_prem,
+                   ipu_instal_prem,
+                   ipu_prev_ri_si,
+                   ipu_policy_status,
+                   ipu_earthqke_prem_diff,
+                   ipu_override_ri_retention,
+                   ipu_risk_oth_int_parties,
+                   ipu_prorata_sect_prem,
+                   ipu_nonprorata_sect_prem,
+                   ipu_prev_prorata_sect_prem,
+                   ipu_prev_nonprorata_sect_prem,
+                   ipu_tot_prorata_sect_prem,
+                   ipu_tot_nonprorata_sect_prem,
                    ipu_prev_tot_prorata_s_prem,
-                   ipu_prev_tot_nonprorata_s_prem, ipu_sub_agn_comm_rate,
-                   ipu_sub_agn_comm_amt, ipu_lta_endos_com_amt,
-                   ipu_lta_commission, ipu_lta_comm_rate,
-                   ipu_admin_fee_disc_amt, ipu_admin_fee_disc_rate,
-                   ipu_lta_comm_disc_rate, ipu_lta_comm_disc_amt,
-                   ipu_tot_families, ipu_tot_individuals, ipu_tot_females,
-                   ipu_tot_males, ipu_conveyance_type, ipu_stamp_duty,
-                   ipu_mktr_com_amt, ipu_mktr_com_rate, ipu_vat_amt,
-                   ipu_vat_rate, ipu_comm_disc_type, ipu_comm_disc_rate,
-                   ipu_comm_disc_amt, ipu_prev_status, ipu_rs_code,
-                   ipu_rescue_mem, ipu_ped_code, ipu_cover_suspended,
-                   ipu_suspend_wef, ipu_suspend_wet, ipu_ncd_cert_no,
-                   ipu_pymt_install_pcts, ipu_susp_reinstmt_type,
-                   ipu_install_period, ipu_rescue_charge,
-                   ipu_previous_insurer, ipu_next_inst_prem, ipu_wtht,
-                   ipu_drcr_no, ipu_post_retro_wet, ipu_post_retro_cover,
-                   ipu_co_phfund, ipu_cover_note_remarks, ipu_cover_note_wet,
-                   ipu_cover_note_wef, ipu_cover_note_date, ipu_cover_note_by,
-                   ipu_cover_note_no)
-         SELECT v_new_ipu_code, ipu_property_id, ipu_item_desc, ipu_qty,
-                ipu_value, ipu_wef, ipu_wet, ipu_pol_policy_no,
-                ipu_pol_ren_endos_no, ipu_pol_batch_no, ipu_basic_premium,
-                ipu_nett_premium, ipu_compulsory_excess, ipu_add_theft_excess,
-                ipu_add_exp_excess, ipu_prr_rate, ipu_comp_retention,
-                ipu_pol_est_max_loss, ipu_avail_fulc_bal, ipu_endos_diff_amt,
-                ipu_prem_wef, ipu_earth_quake_cover, ipu_earth_quake_prem,
-                ipu_location, ipu_itl, ipu_polin_code, ipu_sec_sect_code,
-                ipu_sect_sht_desc, ipu_sec_scl_code, ipu_ncd_status,
-                ipu_cert_issued, ipu_related_ipu_code, ipu_prorata, ipu_bp,
-                ipu_gp, ipu_fp, ipu_fap, ipu_prev_ipu_code,
-                ipu_cummulative_reins, ipu_eml_si, ipu_reinsured, ipu_ct_code,
-                ipu_sht_desc, ipu_quz_code, ipp_quz_sht_desc,
-                ipu_quz_sht_desc, ipu_ncl_level, ipu_ncd_level, TO_NUMBER (TO_CHAR (SYSDATE, 'RRRR'))
-                               || gin_ipu_id_seq.NEXTVAL/*ipu_id*/,
-                ipu_gross_comp_retention, ipu_bind_code, ipu_commission,
-                ipu_comm_endos_diff_amt, ipu_facre_amount, ipu_clp_code,
-                ipu_excess_rate, ipu_excess_type, ipu_excess_rate_type,
-                ipu_excess_min, ipu_excess_max, ipu_prereq_ipu_code,
-                ipu_escalation_rate, ipu_endos_remove, ipu_comm_rate,
-                ipu_prev_batch_no, ipu_cur_code, ipu_relr_code,
-                ipu_relr_sht_desc, ipu_reinsure_amt, ipu_prp_code,
-                ipu_max_exposure, ipu_com_retention_rate, ipu_eff_wef,
-                ipu_eff_wet, ipu_retro_cover, ipu_retro_wef, ipu_covt_code,
-                ipu_covt_sht_desc, ipu_si_diff, ipu_terr_code, ipu_terr_desc,
-                ipu_comments, ipu_from_time, ipu_to_time, ipu_mar_cert_no,
-                ipu_tot_endos_prem_dif, ipu_tot_gp, ipu_tot_value,
-                ipu_cover_days, ipu_grp_comp_net_ret, ipu_grp_si_risk_pct,
-                ipu_grp_top_loc, ipu_grp_comp_gross_ret, ipu_prev_prem,
-                ipu_current_prrd_code, ipu_ri_agnt_com_rate,
-                ipu_ri_agnt_comm_amt, ipu_tot_fap, ipu_max_dc_refund_pct,
-                ipu_extra_premium, ipu_status, ipu_uw_yr,
-                ipu_endose_fap_or_bc, ipu_tot_first_loss,
-                ipu_accumulation_limit, ipu_compute_max_exposure,
-                ipu_trans_eff_wet, ipu_prem_tax, ipu_rate_change_comment,
-                ipu_trans_count, ipu_paid_premium, ipu_paid_tl,
-                ipu_inception_uwyr, ipu_prem_comment, ipu_coin_tl,
-                ipu_dc_paid_premium, ipu_dc_ap, ipu_item_details,
-                ipu_eml_based_on, ipu_aggregate_limits, ipu_rc_code,
-                ipu_rc_sht_desc, ipu_free_limit, ipu_contrad_ipu_code,
-                ipu_survey_date, ipu_declared, ipu_prev_fap, ipu_prev_tot_fap,
-                ipu_min_premium_used, ipu_cancellation_days,
-                ipu_allowed_comm_rate, ipu_allowed_comm_amt,
-                ipu_dc_penalty_pct, ipu_reinsure_diff_amt,
-                ipu_prev_reinsure_amt, ipu_phfund, ipu_coin_phfund,
-                ipu_enforce_cvt_min_prem, ipu_instal_prem, ipu_prev_ri_si,
-                ipu_policy_status, ipu_earthqke_prem_diff,
-                ipu_override_ri_retention, ipu_risk_oth_int_parties,
-                ipu_prorata_sect_prem, ipu_nonprorata_sect_prem,
-                ipu_prev_prorata_sect_prem, ipu_prev_nonprorata_sect_prem,
-                ipu_tot_prorata_sect_prem, ipu_tot_nonprorata_sect_prem,
-                ipu_prev_tot_prorata_s_prem, ipu_prev_tot_nonprorata_s_prem,
-                ipu_sub_agn_comm_rate, ipu_sub_agn_comm_amt,
-                ipu_lta_endos_com_amt, ipu_lta_commission, ipu_lta_comm_rate,
-                ipu_admin_fee_disc_amt, ipu_admin_fee_disc_rate,
-                ipu_lta_comm_disc_rate, ipu_lta_comm_disc_amt,
-                ipu_tot_families, ipu_tot_individuals, ipu_tot_females,
-                ipu_tot_males, ipu_conveyance_type, ipu_stamp_duty,
-                ipu_mktr_com_amt, ipu_mktr_com_rate, ipu_vat_amt,
-                ipu_vat_rate, ipu_comm_disc_type, ipu_comm_disc_rate,
-                ipu_comm_disc_amt, ipu_prev_status, ipu_rs_code,
-                ipu_rescue_mem, ipu_ped_code, ipu_cover_suspended,
-                ipu_suspend_wef, ipu_suspend_wet, ipu_ncd_cert_no,
-                ipu_pymt_install_pcts, ipu_susp_reinstmt_type,
-                ipu_install_period, ipu_rescue_charge, ipu_previous_insurer,
-                ipu_next_inst_prem, ipu_wtht, ipu_drcr_no, ipu_post_retro_wet,
-                ipu_post_retro_cover, ipu_co_phfund, ipu_cover_note_remarks,
-                ipu_cover_note_wet, ipu_cover_note_wef, ipu_cover_note_date,
-                ipu_cover_note_by, ipu_cover_note_no
-           FROM gin_insured_property_unds
-          WHERE ipu_code = v_ipu_code;
+                   ipu_prev_tot_nonprorata_s_prem,
+                   ipu_sub_agn_comm_rate,
+                   ipu_sub_agn_comm_amt,
+                   ipu_lta_endos_com_amt,
+                   ipu_lta_commission,
+                   ipu_lta_comm_rate,
+                   ipu_admin_fee_disc_amt,
+                   ipu_admin_fee_disc_rate,
+                   ipu_lta_comm_disc_rate,
+                   ipu_lta_comm_disc_amt,
+                   ipu_tot_families,
+                   ipu_tot_individuals,
+                   ipu_tot_females,
+                   ipu_tot_males,
+                   ipu_conveyance_type,
+                   ipu_stamp_duty,
+                   ipu_mktr_com_amt,
+                   ipu_mktr_com_rate,
+                   ipu_vat_amt,
+                   ipu_vat_rate,
+                   ipu_comm_disc_type,
+                   ipu_comm_disc_rate,
+                   ipu_comm_disc_amt,
+                   ipu_prev_status,
+                   ipu_rs_code,
+                   ipu_rescue_mem,
+                   ipu_ped_code,
+                   ipu_cover_suspended,
+                   ipu_suspend_wef,
+                   ipu_suspend_wet,
+                   ipu_ncd_cert_no,
+                   ipu_pymt_install_pcts,
+                   ipu_susp_reinstmt_type,
+                   ipu_install_period,
+                   ipu_rescue_charge,
+                   ipu_previous_insurer,
+                   ipu_next_inst_prem,
+                   ipu_wtht,
+                   ipu_drcr_no,
+                   ipu_post_retro_wet,
+                   ipu_post_retro_cover,
+                   ipu_co_phfund,
+                   ipu_cover_note_remarks,
+                   ipu_cover_note_wet,
+                   ipu_cover_note_wef,
+                   ipu_cover_note_date,
+                   ipu_cover_note_by,
+                   ipu_cover_note_no,
+                   ipu_health_tax,
+                   ipu_motor_tax,
+                   ipu_certchg,
+                   ipu_road_safety_tax,
+                   ipu_client_vat_amt,
+                   ipu_motor_levy,
+                   ipu_overrideride_ret_type,
+                   ipu_db_code,
+                   ipu_rare_model,
+                   ipu_cashback_appl,
+                   ipu_cashback_level,
+                   ipu_vehicle_model,
+                   ipu_vehicle_make,
+                   ipu_vehicle_model_code,
+                   ipu_vehicle_make_code,
+                   ipu_loc_town,
+                   ipu_prop_address,
+                   ipu_other_com_charges,
+                   ipu_risk_note,
+                   ipu_model_yr,
+                   ipu_insured_driver,
+                   ipu_cert_no,
+                   ipu_validate_ucr,
+                   ipu_ucr_code,
+                   ipu_pip_code,
+                   ipu_pip_pf_code,
+                   ipu_survey_agnt_code,
+                   ipu_quza_code,
+                   ipu_survey,
+                   ipu_maintenance_period_type,
+                   ipu_maintenance_period,
+                   ipu_other_client_deductibles,
+                   ipu_coin_other_client_charges
+              FROM gin_insured_property_unds
+             WHERE ipu_code = v_ipu_code;
 
---      INSERT INTO gin_policy_active_risks
---                  (polar_pol_batch_no, polar_ipu_code, polar_prev_batch_no,
---                   polar_ipu_id, polar_pol_policy_no, polar_prp_code)
---         SELECT polar_pol_batch_no, v_new_ipu_code, polar_prev_batch_no,
---                polar_ipu_id, polar_pol_policy_no, polar_prp_code
---           FROM gin_policy_active_risks
---          WHERE polar_ipu_code = v_ipu_code;
 
-      INSERT INTO gin_policy_clauses
-                  (pocl_sbcl_cls_code, pocl_cls_sht_desc, pocl_sbcl_scl_code,
-                   pocl_pol_policy_no, pocl_pol_ren_endos_no,
-                   pocl_pol_batch_no, pocl_ipu_code, plcl_cls_type,
-                   pocl_clause, pocl_cls_editable, pocl_new, pocl_heading)
-         SELECT pocl_sbcl_cls_code, pocl_cls_sht_desc, pocl_sbcl_scl_code,
-                pocl_pol_policy_no, pocl_pol_ren_endos_no, pocl_pol_batch_no,
-                v_new_ipu_code, plcl_cls_type, pocl_clause, pocl_cls_editable,
-                pocl_new, pocl_heading
-           FROM gin_policy_clauses
-          WHERE pocl_ipu_code = v_ipu_code;
+        IF v_is_motor_risk = 'Y'
+        THEN
+            BEGIN
+                gin_stp_uw_pkg.populate_cert_to_print (v_ipu_pol_batch_no,
+                                                       'N',
+                                                       'N',
+                                                       NULL,
+                                                       v_new_ipu_code);
+            EXCEPTION
+                WHEN OTHERS
+                THEN
+                    raise_error (
+                           'Error allocating certificates at step 1....'
+                        || SQLERRM (SQLCODE));
+            END;
+        END IF;
 
-      INSERT INTO gin_policy_insured_limits
-                  (pil_code, pil_ipu_code, pil_sect_code, pil_sect_sht_desc,
-                   pil_row_num, pil_calc_group, pil_limit_amt, pil_prem_rate,
-                   pil_prem_amt, pil_rate_type, pil_rate_desc, pil_sect_type,
-                   pil_sect_excess_detail, pil_original_prem_rate,
-                   pil_rate_change_remarks, pil_change_done_by,
-                   pil_min_premium, pil_comment, pil_multiplier_rate,
-                   pil_multiplier_div_factor, pil_annual_premium,
-                   pil_rate_div_fact, pil_desc, pil_used_limit, pil_compute,
-                   pil_indem_prd, pil_prd_type, pil_indem_fstprd,
-                   pil_indem_fstprd_pct, pil_indem_remprd_pct, pil_dual_basis,
-                   pil_prem_accumulation, pil_prem_prorata, pil_prev_prem,
-                   pil_declaration_section, pil_prev_limit, pil_actual_prem,
-                   pil_prev_prem_prorata, pil_annual_actual_prem, pil_eml_pct,
-                   pil_top_loc_rate, pil_top_loc_div_fact, pil_free_limit_amt,
-                   pil_limit_prd, pil_actual_rate_prem,
-                   pil_prev_endr_prem_rate, pil_prev_endr_rate_div_fact,
-                   pil_prev_endr_mult_rate, pil_prev_endr_mult_div_fact,
-                   pil_expired, pil_free_limit, pil_prorata_full,
-                   pil_si_limit_type, pil_si_rate, pil_cover_type,
-                   pil_prr_max_rate, pil_prr_min_rate)
-         SELECT gin_pil_code_seq.NEXTVAL, v_new_ipu_code, pil_sect_code,
-                pil_sect_sht_desc, pil_row_num, pil_calc_group, pil_limit_amt,
-                pil_prem_rate, pil_prem_amt, pil_rate_type, pil_rate_desc,
-                pil_sect_type, pil_sect_excess_detail, pil_original_prem_rate,
-                pil_rate_change_remarks, pil_change_done_by, pil_min_premium,
-                pil_comment, pil_multiplier_rate, pil_multiplier_div_factor,
-                pil_annual_premium, pil_rate_div_fact, pil_desc,
-                pil_used_limit, pil_compute, pil_indem_prd, pil_prd_type,
-                pil_indem_fstprd, pil_indem_fstprd_pct, pil_indem_remprd_pct,
-                pil_dual_basis, pil_prem_accumulation, pil_prem_prorata,
-                pil_prev_prem, pil_declaration_section, pil_prev_limit,
-                pil_actual_prem, pil_prev_prem_prorata,
-                pil_annual_actual_prem, pil_eml_pct, pil_top_loc_rate,
-                pil_top_loc_div_fact, pil_free_limit_amt, pil_limit_prd,
-                pil_actual_rate_prem, pil_prev_endr_prem_rate,
-                pil_prev_endr_rate_div_fact, pil_prev_endr_mult_rate,
-                pil_prev_endr_mult_div_fact, pil_expired, pil_free_limit,
-                pil_prorata_full, pil_si_limit_type, pil_si_rate,
-                pil_cover_type, pil_prr_max_rate, pil_prr_min_rate
-           FROM gin_policy_insured_limits
-          WHERE pil_ipu_code = v_ipu_code;
+        --      INSERT INTO gin_policy_active_risks
+        --                  (polar_pol_batch_no, polar_ipu_code, polar_prev_batch_no,
+        --                   polar_ipu_id, polar_pol_policy_no, polar_prp_code)
+        --         SELECT polar_pol_batch_no, v_new_ipu_code, polar_prev_batch_no,
+        --                polar_ipu_id, polar_pol_policy_no, polar_prp_code
+        --           FROM gin_policy_active_risks
+        --          WHERE polar_ipu_code = v_ipu_code;
+        INSERT INTO gin_policy_clauses (pocl_sbcl_cls_code,
+                                        pocl_cls_sht_desc,
+                                        pocl_sbcl_scl_code,
+                                        pocl_pol_policy_no,
+                                        pocl_pol_ren_endos_no,
+                                        pocl_pol_batch_no,
+                                        pocl_ipu_code,
+                                        plcl_cls_type,
+                                        pocl_clause,
+                                        pocl_cls_editable,
+                                        pocl_new,
+                                        pocl_heading)
+            SELECT pocl_sbcl_cls_code,
+                   pocl_cls_sht_desc,
+                   pocl_sbcl_scl_code,
+                   pocl_pol_policy_no,
+                   pocl_pol_ren_endos_no,
+                   pocl_pol_batch_no,
+                   v_new_ipu_code,
+                   plcl_cls_type,
+                   pocl_clause,
+                   pocl_cls_editable,
+                   pocl_new,
+                   pocl_heading
+              FROM gin_policy_clauses
+             WHERE pocl_ipu_code = v_ipu_code;
 
-      INSERT INTO gin_pol_sec_perils
-                  (gpsp_per_code, gpsp_per_sht_desc, gpsp_sec_sect_code,
-                   gpsp_sect_sht_desc, gpsp_sec_scl_code, gpsp_ipp_code,
-                   gpsp_ipu_code, gpsp_limit_amt, gpsp_excess_amt,
-                   gsps_min_excess_amt, gsps_excess_calc_type,
-                   gsps_excess_percentage)
-         SELECT gpsp_per_code, gpsp_per_sht_desc, gpsp_sec_sect_code,
-                gpsp_sect_sht_desc, gpsp_sec_scl_code, gpsp_ipp_code,
-                v_new_ipu_code, gpsp_limit_amt, gpsp_excess_amt,
-                gsps_min_excess_amt, gsps_excess_calc_type,
-                gsps_excess_percentage
-           FROM gin_pol_sec_perils
-          WHERE gpsp_ipu_code = v_ipu_code;
+        INSERT INTO gin_policy_insured_limits (pil_code,
+                                               pil_ipu_code,
+                                               pil_sect_code,
+                                               pil_sect_sht_desc,
+                                               pil_row_num,
+                                               pil_calc_group,
+                                               pil_limit_amt,
+                                               pil_prem_rate,
+                                               pil_prem_amt,
+                                               pil_rate_type,
+                                               pil_rate_desc,
+                                               pil_sect_type,
+                                               pil_sect_excess_detail,
+                                               pil_original_prem_rate,
+                                               pil_rate_change_remarks,
+                                               pil_change_done_by,
+                                               pil_min_premium,
+                                               pil_comment,
+                                               pil_multiplier_rate,
+                                               pil_multiplier_div_factor,
+                                               pil_annual_premium,
+                                               pil_rate_div_fact,
+                                               pil_desc,
+                                               pil_used_limit,
+                                               pil_compute,
+                                               pil_indem_prd,
+                                               pil_prd_type,
+                                               pil_indem_fstprd,
+                                               pil_indem_fstprd_pct,
+                                               pil_indem_remprd_pct,
+                                               pil_dual_basis,
+                                               pil_prem_accumulation,
+                                               pil_prem_prorata,
+                                               pil_prev_prem,
+                                               pil_declaration_section,
+                                               pil_prev_limit,
+                                               pil_actual_prem,
+                                               pil_prev_prem_prorata,
+                                               pil_annual_actual_prem,
+                                               pil_eml_pct,
+                                               pil_top_loc_rate,
+                                               pil_top_loc_div_fact,
+                                               pil_free_limit_amt,
+                                               pil_limit_prd,
+                                               pil_actual_rate_prem,
+                                               pil_prev_endr_prem_rate,
+                                               pil_prev_endr_rate_div_fact,
+                                               pil_prev_endr_mult_rate,
+                                               pil_prev_endr_mult_div_fact,
+                                               pil_expired,
+                                               pil_free_limit,
+                                               pil_prorata_full,
+                                               pil_si_limit_type,
+                                               pil_si_rate,
+                                               pil_cover_type,
+                                               pil_prr_max_rate,
+                                               pil_prr_min_rate,
+                                               pil_firstloss,
+                                               pil_firstloss_amt_pcnt,
+                                               pil_firstloss_value)
+            SELECT gin_pil_code_seq.NEXTVAL,
+                   v_new_ipu_code,
+                   pil_sect_code,
+                   pil_sect_sht_desc,
+                   pil_row_num,
+                   pil_calc_group,
+                   pil_limit_amt,
+                   pil_prem_rate,
+                   pil_prem_amt,
+                   pil_rate_type,
+                   pil_rate_desc,
+                   pil_sect_type,
+                   pil_sect_excess_detail,
+                   pil_original_prem_rate,
+                   pil_rate_change_remarks,
+                   pil_change_done_by,
+                   pil_min_premium,
+                   pil_comment,
+                   pil_multiplier_rate,
+                   pil_multiplier_div_factor,
+                   pil_annual_premium,
+                   pil_rate_div_fact,
+                   pil_desc,
+                   pil_used_limit,
+                   pil_compute,
+                   pil_indem_prd,
+                   pil_prd_type,
+                   pil_indem_fstprd,
+                   pil_indem_fstprd_pct,
+                   pil_indem_remprd_pct,
+                   pil_dual_basis,
+                   pil_prem_accumulation,
+                   pil_prem_prorata,
+                   pil_prev_prem,
+                   pil_declaration_section,
+                   pil_prev_limit,
+                   pil_actual_prem,
+                   pil_prev_prem_prorata,
+                   pil_annual_actual_prem,
+                   pil_eml_pct,
+                   pil_top_loc_rate,
+                   pil_top_loc_div_fact,
+                   pil_free_limit_amt,
+                   pil_limit_prd,
+                   pil_actual_rate_prem,
+                   pil_prev_endr_prem_rate,
+                   pil_prev_endr_rate_div_fact,
+                   pil_prev_endr_mult_rate,
+                   pil_prev_endr_mult_div_fact,
+                   pil_expired,
+                   pil_free_limit,
+                   pil_prorata_full,
+                   pil_si_limit_type,
+                   pil_si_rate,
+                   pil_cover_type,
+                   pil_prr_max_rate,
+                   pil_prr_min_rate,
+                   pil_firstloss,
+                   pil_firstloss_amt_pcnt,
+                   pil_firstloss_value
+              FROM gin_policy_insured_limits
+             WHERE pil_ipu_code = v_ipu_code;
 
-      INSERT INTO gin_risk_excess
-                  (re_ipu_code, re_excess_rate, re_excess_type,
-                   re_excess_rate_type, re_excess_min, re_excess_max,
-                   re_comments)
-         SELECT v_new_ipu_code, re_excess_rate, re_excess_type,
-                re_excess_rate_type, re_excess_min, re_excess_max,
-                re_comments
-           FROM gin_risk_excess
-          WHERE re_ipu_code = v_ipu_code;
-   END;
+        INSERT INTO gin_pol_sec_perils (gpsp_per_code,
+                                        gpsp_per_sht_desc,
+                                        gpsp_sec_sect_code,
+                                        gpsp_sect_sht_desc,
+                                        gpsp_sec_scl_code,
+                                        gpsp_ipp_code,
+                                        gpsp_ipu_code,
+                                        gpsp_limit_amt,
+                                        gpsp_excess_amt,
+                                        gsps_min_excess_amt,
+                                        gsps_excess_calc_type,
+                                        gsps_excess_percentage)
+            SELECT gpsp_per_code,
+                   gpsp_per_sht_desc,
+                   gpsp_sec_sect_code,
+                   gpsp_sect_sht_desc,
+                   gpsp_sec_scl_code,
+                   gpsp_ipp_code,
+                   v_new_ipu_code,
+                   gpsp_limit_amt,
+                   gpsp_excess_amt,
+                   gsps_min_excess_amt,
+                   gsps_excess_calc_type,
+                   gsps_excess_percentage
+              FROM gin_pol_sec_perils
+             WHERE gpsp_ipu_code = v_ipu_code;
+
+        INSERT INTO gin_risk_excess (re_ipu_code,
+                                     re_excess_rate,
+                                     re_excess_type,
+                                     re_excess_rate_type,
+                                     re_excess_min,
+                                     re_excess_max,
+                                     re_comments)
+            SELECT v_new_ipu_code,
+                   re_excess_rate,
+                   re_excess_type,
+                   re_excess_rate_type,
+                   re_excess_min,
+                   re_excess_max,
+                   re_comments
+              FROM gin_risk_excess
+             WHERE re_ipu_code = v_ipu_code;
+    END;